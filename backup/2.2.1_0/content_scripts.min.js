class Common{constructor(){this.inputClickType=["button","checkbox","radio","checkbox"],this.retry=auto_click_settings.retry||5,this.retryInterval=1e3*(auto_click_settings.retryInterval||1),this.retryOption=auto_click_settings.retryOption||0,this.checkiFrames=auto_click_settings.checkiFrames||!1}start(t){try{0===this.getNodes().snapshotLength?(this.nodes=void 0,this.retryFunc(t)):this[t]()}catch(t){this.notify(`'${this.xpath}'\n\nClick to fix configuration.`,"Invalid XPath",{error_xpath:this.xpath,url:this.url})}}getNodes(){return this.nodes||(this.nodes=document.evaluate(this.xpath,document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null))}retryFunc(t){this.retry>0?(this.retry--,0===this.retryInterval?this.start(t):setTimeout(this.start.bind(this,t),this.retryInterval)):this.checkiFrames?this.loadiFrames(t):this.notFound()}loadiFrames(t){let e=document.getElementsByTagName("iframe");for(let t=0;t<e.length;t++)try{this.nodes&&0!==this.nodes.snapshotLength||(this.nodes=document.evaluate(this.xpath,e[t].contentDocument,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null))}catch(t){console.error(t)}this.nodes&&0!==this.nodes.snapshotLength?this[t]():this.notFound()}notFound(){1==this.retryOption?this.success(`${this.xpath} action Skipped!`):2==this.retryOption&&("complete"===document.readyState?location.reload():window.addEventListener("load",function(){location.reload()})),this.notify(`'${this.xpath}'\n\nClick to fix configuration.`,"XPath element not found",{error_xpath:this.xpath,url:this.url})}log(t){Logger.log(t)}success(t){this.resolve(t)}notify(t,e,s){chrome.runtime.sendMessage({action:"notif",options:{title:e||"Error",message:t,requireInteraction:!0},extras:{url:"options_page/index.html",query:s}})}error(t){this.reject(t)}}
class Action extends Common{constructor(t,e,i){super();try{return this.bind(),this.xpath=t.xpath.replace("[$]",`[${i}]`),this.url=e,this.setRepeatInterval(t),this.repeat=t.repeat||0,this.value=t.value,this.checkAddon(t),new Promise((t,e)=>{this.resolve=t,this.reject=e})}catch(t){this.error(t)}}bind(){this.repeatFunc=this.repeatFunc.bind(this),this.error=this.error.bind(this)}checkAddon(t){t.addon?new Addon(t.addon,this.url).then(e=>{-1!==e.indexOf("Skipped")?this.success(e):this.initWait(t)}).catch(this.error.bind(this)):this.initWait(t)}setRepeatInterval(t){if(null!==new String(t.repeatInterval).match("e")){let e=new String(t.repeatInterval).split("e");this.repeatInterval=1e3*e[0],this.rangeInterval=1e3*e[1]}else this.repeatInterval=1e3*(t.repeatInterval||0)}initWait(t){if(null!==new String(t.initWait).match("e")){let e=new String(t.initWait).split("e");setTimeout(this.start.bind(this,"check"),Math.floor(Math.random()*e[1]*1e3)+1e3*e[0])}else setTimeout(this.start.bind(this,"check"),1e3*(t.initWait||0))}check(){this.value?/^scrollto/gi.test(this.value)?new ScrollTo(this.nodes,this.xpath,this.value).then(this.repeatFunc).catch(this.error):/^clickevents::/gi.test(this.value)?new ClickEvents(this.nodes,this.value).then(this.repeatFunc).catch(this.error):/^formevents::/gi.test(this.value)?new FormEvents(this.nodes,this.value).then(this.repeatFunc).catch(this.error):/^execcommand::/gi.test(this.value)?new ExecCommand(this.value).then(this.repeatFunc).catch(this.error):new Fill(this.nodes,this.value).then(this.repeatFunc).catch(this.error):new ClickEvents(this.nodes,"ClickEvents::click").then(this.repeatFunc).catch(this.error)}repeatFunc(){this.repeat>0||this.repeat<-1?(this.repeat--,void 0!==this.rangeInterval?setTimeout(this.check.bind(this),Math.floor(Math.random()*this.rangeInterval)+this.repeatInterval):0===this.repeatInterval?this.check():setTimeout(this.check.bind(this),this.repeatInterval)):this.success(`${this.xpath} action executed Successfully!`)}}
class Addon extends Common{constructor(t,e){return super(),this.xpath=t.xpath,this.url=e,this.condition=t.condition,this.value=t.value,new Promise((t,e)=>{this.reject=e,this.resolve=t,this.xpath&&this.condition&&this.value?this.start("check"):this.success(`ADDON: xpath:${this.xpath} condition:${this.condition} value:${this.value}`)})}check(){let t=0;for(;t<this.nodes.snapshotLength;){let e,i=this.nodes.snapshotItem(t++);e="SELECT"===i.nodeName||"TEXTAREA"===i.nodeName?i.value:"INPUT"===i.nodeName&&-1===this.inputClickType.indexOf(i.type)?i.value:i.innerText,this.checkCondition(e)?this.success(`Condition Success! xPathValue:${e} ${this.condition} value:${this.value}`):1==this.retryOption?this.success(`${this.xpath} addon Skipped!`):this.notify(`xPathValue:${e} ~ ${this.condition} ~ value:${this.value}`,"Condition Failed!",{error_addon_xpath:this.xpath,url:this.url})}}checkCondition(t){switch(this.condition){case"Equals":return new RegExp(`^${this.value}$`,"gi").test(t);case"NotEquals":return!new RegExp(`^${this.value}$`,"gi").test(t);case"Contains":return new RegExp(`${this.value}`,"gi").test(t);case"GreaterThan":return t>this.value;case"LessThan":return t<this.value;case"GreaterThanEquals":return t>=this.value;case"LessThanEquals":return t<=this.value;default:return this.notify(`${this.condition} condition not found`,"Condition not found"),!1}}}
class Batch{constructor(t){try{if(null!==new String(t.repeatInterval).match("e")){let e=new String(t.repeatInterval).split("e");this.repeatInterval=1e3*e[0],this.rangeInterval=1e3*e[1]}else this.repeatInterval=1e3*(t.repeatInterval||0);if(this.refresh=t.refresh||!1,this.url=t.url,this.repeat=t.repeat,this.actions=t.actions,this.actionLength=0,this.batchCounter=1,null!==new String(t.initWait).match("e")){let e=new String(t.initWait).split("e");setTimeout(this.action.bind(this),Math.floor(Math.random()*e[1]*1e3)+1e3*e[0])}else setTimeout(this.action.bind(this),1e3*(t.initWait||0));return new Promise((t,e)=>{this.resolve=t,this.reject=e})}catch(t){this.error(t)}}action(){if(this.actionLength<this.actions.length){let t=this.actions[this.actionLength];new Action(t,this.url,this.batchCounter).then(t=>{this.actionLength++,this.action()}).catch(this.error.bind(this))}else this.repeatFunc()}repeatFunc(){this.repeat>0||this.repeat<-1?(this.actionLength=0,this.batchCounter++,void 0!==this.rangeInterval?setTimeout(this.action.bind(this),Math.floor(Math.random()*this.rangeInterval)+this.repeatInterval):0===this.repeatInterval?this.action():setTimeout(this.action.bind(this),this.repeatInterval),this.repeat--):(this.success("Batch executed Successfully!"),this.refresh&&location.reload())}success(t){this.resolve(t)}error(t){this.reject(t)}}
function handleResponse(e){try{new Processor(e)}catch(e){onError(e)}}function getConfigs(){chrome.runtime.sendMessage({action:"config",URL:document.location.href,frameElement:window.frameElement},handleResponse)}
document.addEventListener("DOMContentLoaded",function(){chrome.runtime.sendMessage({action:"localStorage",type:"GET",key:"settings"},function(t){try{auto_click_settings=t,auto_click_settings&&1==auto_click_settings.load&&getConfigs()}catch(t){onError(t)}})}),window.addEventListener("load",function(){chrome.runtime.sendMessage({action:"localStorage",type:"GET",key:"settings"},function(t){try{auto_click_settings=t||{load:0},auto_click_settings&&1!=auto_click_settings.load&&getConfigs()}catch(t){onError(t)}})}),onError=(t=>window.chrome.runtime.sendMessage({action:"error",page:"content_scripts",error:t.stack}));
const EXEC_COMMANDS=["cut","copy","delete","paste","selectAll"];class ExecCommand extends Common{constructor(e){super();try{return this.execCommands=this.getExecCommands(EXEC_COMMANDS,e),new Promise((t,s)=>{this.resolve=t,this.reject=s,0!==this.execCommands.length?(this.execCommand(),this.success(`${this.execCommands} command exec Successfully!`)):this.error(`${e} not found`)})}catch(e){this.error(e)}}getExecCommands(e,t){let s=t.split("::")[1];try{return JSON.parse(s).filter(t=>-1!==e.indexOf(t))}catch(t){return-1!==e.indexOf(s.replace(/\W/g,""))?[s.replace(/\W/g,"")]:[]}}execCommand(){this.execCommands.forEach(e=>{document.execCommand(e,!1,null)})}}
class Fill extends Common{constructor(e,t){super();try{return new Promise((s,c)=>{this.resolve=s,this.reject=c,this.value=this.checkEmptyValue(t),e.snapshotLength?this.loopNodes(e,this.value):this.checkNode(e,this.value),this.success(`${t} filled successfully!`)})}catch(e){this.error(e)}}checkEmptyValue(e){return"::empty"===e?"":e}loopNodes(e,t){let s=0;for(;s<e.snapshotLength;){let c=e.snapshotItem(s++);this.checkNode(c,t)}}checkNode(e,t){"SELECT"===e.nodeName||"TEXTAREA"===e.nodeName||"INPUT"===e.nodeName&&-1===this.inputClickType.indexOf(e.type)?(e.value=t,this.dispatchEvent(e)):new ClickEvents(e,"ClickEvents::click").catch(this.error.bind(this))}dispatchEvent(e){let t=document.createEvent("HTMLEvents");t.initEvent("change",!1,!0),e.dispatchEvent(t),e.focus()}}
class Processor{constructor(e){try{e&&(e.enable?e.startTime&&e.startTime.match(/^\d{2}:\d{2}:\d{2}$/)?this.schedule(e):(this.record=e,new Batch(e).then(this.success.bind(this)).catch(onError)):e.expired&&chrome.runtime.sendMessage({action:"notif",options:{title:"Auto Click PRO Expired",message:"Your Auto Click PRO License is expired!",requireInteraction:!0,iconUrl:"assets/icons/icon_black64.png"},important:!0}))}catch(e){onError(e)}}schedule(e){var t=new Date;t.setHours(e.startTime.split(":")[0]),t.setMinutes(e.startTime.split(":")[1]),t.setSeconds(e.startTime.split(":")[2]),setTimeout(()=>{this.record=e,new Batch(e).then(this.success.bind(this)).catch(onError)},t.getTime()-(new Date).getTime())}success(e){let t=this.record,i=!1;e:for(let e in t)if("actions"==e){for(let e in t.actions)for(let s in t.actions[e])if(-1!==["initWait","repeat","repeatInterval"].indexOf(s)&&0!=t.actions[e][s]){i=!0;break e}}else if(-1!==["initWait","repeat","repeatInterval"].indexOf(e)&&0!=t[e]){i=!0;break e}i&&chrome.runtime.sendMessage({action:"ga"})}}
const SCROLL_COORDINATES=["Top","Bottom","Left","Right","TopLeft","BottomLeft","BottomRight","TopRight"];class ScrollTo extends Common{constructor(o,t,s){super(),this.xpath=t;try{return new Promise((t,e)=>{this.resolve=t,this.reject=e;let l=s.split("::")[1]||"xpath";-1!==SCROLL_COORDINATES.indexOf(l)?this.scrollToCoordinates(l):/xpath/gi.test(l)?this.scrollToNode(o):this.error(`Scroll to ${l} is not configrued`)})}catch(o){this.error(o)}}scrollToCoordinates(o){let t=0,s=0;-1!==o.indexOf("Right")&&(t=document.body.scrollWidth),-1!==o.indexOf("Bottom")&&(s=document.body.scrollHeight),window.scrollTo(t,s),this.success(`Scrolled to ${t}, ${s} Coordinates Successfully!`)}scrollToNode(o){o.snapshotItem(0).scrollIntoView(),this.success(`Scrolled to XPath: ${this.xpath} Successfully!`)}}
function setxPathAndURL(t,e){chrome.runtime.sendMessage({action:"setxPathAndURL",url:e.view.document.URL,xpath:t})}function getPathTo(t){if(""!==t.id)return`//*[@id="${t.id}"]`;if(t===document.body)return`html/${t.tagName.toLowerCase()}`;for(var e=1,n=t.parentNode.childNodes,a=0;a<n.length;a++){var o=n[a];if(o===t)return getPathTo(t.parentNode)+`/${t.tagName.toLowerCase()}[${e}]`;1===o.nodeType&&o.tagName===t.tagName&&e++}}document.addEventListener("mousedown",function(t){if(2==t.button){setxPathAndURL(getPathTo(t.target),t)}},!0);
class CommonEvents extends Common{getEventNames(e,t){let n=t.split("::")[1];try{return JSON.parse(n).filter(t=>-1!==e.indexOf(t))}catch(t){return-1!==e.indexOf(n.replace(/\W/g,""))?[n.replace(/\W/g,"")]:[]}}}
const CLICK_EVENTS=["dblclick","click"];class ClickEvents extends CommonEvents{constructor(e,s){super();try{let t=this.getEventNames(CLICK_EVENTS,s);return new Promise((n,o)=>{this.resolve=n,this.reject=o,0!==t.length?(this.setEvents(t),e.snapshotLength?this.loopNodes(e):this.dispatchEvent(e),this.success(`${t} dispatched Successfully!`)):this.error(`${s} not found`)})}catch(e){this.error(e)}}setEvents(e){this.events=["mouseover","mousedown","mouseup",...e]}loopNodes(e){let s=0;for(;s<e.snapshotLength;){let t=e.snapshotItem(s++);this.dispatchEvent(t)}}dispatchEvent(e){this.events.forEach(s=>{let t=new MouseEvent(s,{screenX:10,pageX:10,pageY:10,screenY:10,clientX:10,clientY:10,bubbles:!0,cancelable:!0,view:window});e.dispatchEvent(t)})}}
const FORM_EVENTS=["blur","click","focus","select","submit","remove","clear"];class FormEvents extends CommonEvents{constructor(e,t){super();try{return this.eventNames=this.getEventNames(FORM_EVENTS,t),new Promise((s,r)=>{this.resolve=s,this.reject=r,0!==this.eventNames.length?(this.dispatchEvent(e),this.success(`${this.eventNames} event dispatched Successfully!`)):this.error(`${t} not found`)})}catch(e){this.error(e)}}dispatchEvent(e){try{let t=0;for(;t<e.snapshotLength;){let s=e.snapshotItem(t++);this.eventNames.forEach(e=>{switch(e){case"blur":s.blur();break;case"click":s.click();break;case"focus":s.focus();break;case"submit":"FORM"===s.nodeName?s.submit():null!==s.form?s.form.submit():Logger.error(s,"not of type submit");break;case"select":s.select();break;case"remove":s.remove();break;case"clear":s.value="";break;default:let t=document.createEvent("Event");t.initEvent(e,!0,!0),s.dispatchEvent(t)}})}}catch(e){this.error(e)}}}